//////////////////////////////////////////////////////////////////////////////
// FILE   : _probit_sample.tol
// PURPOSE: BProbit Examples
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
// PROCEDURES
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
// Simulation
//////////////////////////////////////////////////////////////////////////////

Real   N = 100;
Matrix X = Rand(N, 1, 1, 1)|SetCol(Range(1,N,1));
Set paramSet = SetOfReal(1, -0.1);
Matrix Beta  = SetCol(paramSet);
Matrix U     = Gaussian(N, 1, 0, 1);
Matrix Omega = X*Beta-U;
Matrix Y     = GT(Omega, Rand(N, 1, 0,0));

//////////////////////////////////////////////////////////////////////////////
// Definition
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
// MLE Probit
//////////////////////////////////////////////////////////////////////////////
Set Probit_MLE = Probit(Y, X);

//////////////////////////////////////////////////////////////////////////////
// MLE Probit
//////////////////////////////////////////////////////////////////////////////

Set InputDefSet = For(1, Rows(Beta), Set(Real k)
{
  Text name = "Var"+IntText(k);
  BLRParamDef
  (
    name,
    0.1,
    Empty,
    Empty
  )  
});
Set LinSet = SetOfMatrix(((-1,1),(0,1)), SetCol(SetOfReal(0,0)));
Set Probit_Bay = 
 BProbit_Result(Y, X, InputDefSet, Empty, LinSet, 500, 500, "");

