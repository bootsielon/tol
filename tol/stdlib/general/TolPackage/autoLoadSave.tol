/* -*- mode: C++ -*- */
//////////////////////////////////////////////////////////////////////////////
// FILE   : repository.tol
// PURPOSE: Class TolPackage::Client::@AutoLoadSave
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
//El objetivo de esta clase es crear una sola instancia que llame a 
//cuando se cree @Repository::LoadInstances y a @Repository::SaveInstances(0)
//cuando se destruya. No se debe usar fuera de TolPackage.
Class @AutoLoadSave 
//////////////////////////////////////////////////////////////////////////////
{
  //Esta clase no necesita miembros pero la sintaxis de creación de 
  //instancias obliga a que haya uno al menos
  Real _unused;

  ////////////////////////////////////////////////////////////////////////////
  //En el constructor se lee del disco la lista de repositorios
  ////////////////////////////////////////////////////////////////////////////
  Static @AutoLoadSave Create(Real void)
  {
    @AutoLoadSave theOne = 
    [[
      Real _unused = void
    ]];
  //WriteLn("TRACE @AutoLoadSave::Create");
    Real TolPackage::Client::@Repository::LoadInstances(0);
    theOne
  };

  ////////////////////////////////////////////////////////////////////////////
  //En el destructor se almacena en disco la lista de repositorios
  Real __destroy(Real void)
  ////////////////////////////////////////////////////////////////////////////
  {
  //WriteLn("TRACE @AutoLoadSave::__destroy");
    TolPackage::Client::@Repository::SaveInstances(0)
  }

};
