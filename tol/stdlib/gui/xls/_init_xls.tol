//////////////////////////////////////////////////////////////////////////////
// FILE    :
// PURPOSE :
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
Set BDTFileXLSNames(Set series, Text xlsFile, Set names)
//////////////////////////////////////////////////////////////////////////////
{
  Text pre        = GetFilePrefix(xlsFile);
  Text abs        = GetFilePath(GetAbsolutePath(xlsFile));
  Text absXlsFile = abs+"/"+GetFileName(xlsFile);
  Set csvFiles = For(1, Card(series), Text(Real k)
  {
    Text csv = abs + "/" + If(Card(names)>=k,names[k],pre+IntText(k))+".csv";
    Set BDTFile(series[k],csv);
    csv
  });

  Text Do (x = CSV2XLS(csvFiles, absXlsFile));

  Do Set EvalSet(csvFiles, Real(Text csv)
  {
    FileDelete(csv)
  });

  series
};

//////////////////////////////////////////////////////////////////////////////
Set BDTFileXLS(Set series, Text xlsFile)
//////////////////////////////////////////////////////////////////////////////
{
  BDTFileXLS(series, xlsFile, Copy(Empty))
};