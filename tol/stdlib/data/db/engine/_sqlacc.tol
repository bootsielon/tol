//////////////////////////////////////////////////////////////////////////////
// FILE    : _sqlacc.tol
// PURPOSE : Funciones propias del gestor ACCESS
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
// CONSTANTS
//////////////////////////////////////////////////////////////////////////////

Text SqlAccFormatRealTol2Sql = "%.6lf";
Date SqlAccDefaultTheBegin   = y1900m01d01h00i00s00;
Date SqlAccDefaultTheEnd     = y3000m01d01h00i00s00;

//////////////////////////////////////////////////////////////////////////////
// FUNCTIONS
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
Text SqlAccFormatDate(Date dte)
//////////////////////////////////////////////////////////////////////////////
{
  Date dteAux = 
   If(dte == TheBegin, SqlAccDefaultTheBegin,
   If(dte == TheEnd,   SqlAccDefaultTheEnd, dte));

  Text formatDate = FormatDate(dteAux, "%c%Y/%m/%d");
  "#"+formatDate+"#"
};
//////////////////////////////////////////////////////////////////////////////
PutDescription(
"Formateador de fecha con formato dependiente del de TOL al formato 
equivalente Access.",
SqlAccFormatDate);
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
Text SqlAccFormatReal(Real rea)
//////////////////////////////////////////////////////////////////////////////
{
  Real isUnk = IsUnknown(rea);
  Real isInf = IsInfinite(rea);
  If(Or(isUnk, isInf), "0", FormatReal(rea,SqlAccFormatRealTol2Sql))
};
//////////////////////////////////////////////////////////////////////////////
PutDescription(
"Formateador de reales TOL a formato real de Access.",
SqlAccFormatReal);
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
Text SqlAccFormatInteger(Real rea)
//////////////////////////////////////////////////////////////////////////////
{
  Real isUnk = IsUnknown(rea);
  Real isInf = IsInfinite(rea);
  If(Or(isUnk, isInf), "0", IntText(rea))
};
//////////////////////////////////////////////////////////////////////////////
PutDescription(
"Formateador de reales TOL a formato entero de Access. Si el numero no es 
entero lo redondea.",
SqlAccFormatInteger);
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
Text SqlAccFormatText(Text txt)
//////////////////////////////////////////////////////////////////////////////
{ If(txt == "", "format(null)","'"+txt+"'") };
//////////////////////////////////////////////////////////////////////////////
PutDescription(
"Formateador de text a char de Access",
SqlAccFormatText);
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
Text SqlAccFormatPolyn(Polyn pol)
//////////////////////////////////////////////////////////////////////////////
{ 
  If(IsUnknownPolyn(pol), "format(null)", "'"+FormatPolyn(pol)+"'") 
};
//////////////////////////////////////////////////////////////////////////////
PutDescription(
"Formateador de polyn a char de Access",
SqlAccFormatPolyn);
//////////////////////////////////////////////////////////////////////////////
