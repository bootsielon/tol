/* -*- mode: C++ -*- */
//////////////////////////////////////////////////////////////////////////////
// FILE : gen_multivariant_linear_regression.tol
// PURPOSE : generates a random multivariate linear regression model
//////////////////////////////////////////////////////////////////////////////

//Random seed setting
Real PutRandomSeed(0);
Real rndSeed = GetRandomSeed(0);
WriteLn("Current Random Seed = "<<rndSeed);

Real If(!ObjectExist("Real","r.eq"), r.eq = 0, r.eq);

Real d = IntRand(r.eq+2,r.eq+10);
Real m = IntRand(r.eq+2,r.eq+10);
Real N = IntRand(m*5,m*30);
Real sampleLength = 5000;

VMatrix X = Rand(m,N,-10,10);
VMatrix A = Rand(d,m,-10,10); 
VMatrix V = (MMtSqr(Rand(d,N,-0.8,0.8,"Cholmod.R.Sparse",d*N/4))+Eye(d,d)); 
VMatrix V.L = CholeskiFactor(V,"X");
VMatrix E01 = Gaussian(d,N,0,1) ; 
VMatrix E = V*E01;
VMatrix Y = A*X+E; 

VMatrix C = If(!r.eq,Rand(0,d*m,0,0), 
  Round(Rand(r.eq,d*m,-2.5,2.5,"Cholmod.R.Sparse",r.eq*2)));
VMatrix c = If(!r.eq,Rand(0,1,0,0),
  C*BysVecLinReg::vmatrix2vec(A));