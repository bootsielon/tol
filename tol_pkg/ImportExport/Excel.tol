/* -*- mode: C++ -*- */
//////////////////////////////////////////////////////////////////////////////
// FILE   : Excel.tol
// PURPOSE: Defines class ImportExport::Excel
//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////
Text _.autodoc.member.Excel = 
"Importing data from Excel to TOL";
Class @Excel 
//////////////////////////////////////////////////////////////////////////////
{
  Text _.path;
  Real _id = ?;

  ////////////////////////////////////////////////////////////////////////////
  Static @Excel Default(Real void)
  ////////////////////////////////////////////////////////////////////////////
  {
    @Excel new
  };
  ////////////////////////////////////////////////////////////////////////////
  Static @Excel New(Text path)
  ////////////////////////////////////////////////////////////////////////////
  {
    @Excel new =
    [[
      Text _.path = path;
      Real _id = Excel.Open(_.path)
    ]];
    new
  };
  ////////////////////////////////////////////////////////////////////////////
  Real __destroy(Real void)
  ////////////////////////////////////////////////////////////////////////////
  {
    If(!IsUnknown(_id) & _id, Excel.Destroy(_id));
    Real _id := 0;
    True
  };

  ////////////////////////////////////////////////////////////////////////////
  Text _.autodoc.member.ActivateWS = "Activa la n-ésima hoja de cálculo";
  Real ActivateWS(Text n)
  ////////////////////////////////////////////////////////////////////////////
  {
    Excel.ActivateWS(_id, n)
  };

  ////////////////////////////////////////////////////////////////////////////
  Text _.autodoc.member.ActivateNamedWS = "Activa hoja de cálculo con el "
  "nombre especificado";
  Real ActivateNamedWS(Text WorkSheet)
  ////////////////////////////////////////////////////////////////////////////
  {
    Excel.ActivateNamedWS(_id, WorkSheet)
  };

  ////////////////////////////////////////////////////////////////////////////
  Text _.autodoc.member.ReadCell = "Lee en la hoja de trabajo activa el "
  "contenido de una celda de cualquiera de los tres tipos: Text, Date, Real";
  Anything ReadCell(Real Row, Real Column)
  ////////////////////////////////////////////////////////////////////////////
  {
    Excel.ReadCell(_id,Row,Column)
  };

  ////////////////////////////////////////////////////////////////////////////
  Text _.autodoc.member.ReadText = "Lee en la hoja de trabajo activa el "
  "contenido de una celda de tipo Text";
  Text ReadText(Real Row, Real Column)
  ////////////////////////////////////////////////////////////////////////////
  {
    Excel.ReadText(_id,Row,Column)
  };
  ////////////////////////////////////////////////////////////////////////////
  Text _.autodoc.member.ReadDate = "Lee en la hoja de trabajo activa el "
  "contenido de una celda de tipo Text";
  Date ReadDate(Real Row, Real Column)
  ////////////////////////////////////////////////////////////////////////////
  {
    Excel.ReadDate(_id,Row,Column)
  };
  ////////////////////////////////////////////////////////////////////////////
  Text _.autodoc.member.ReadReal = "Lee en la hoja de trabajo activa el "
  "contenido de una celda de tipo Real";
  Real ReadReal(Real Row, Real Column)
  ////////////////////////////////////////////////////////////////////////////
  {
    Excel.ReadReal(_id,Row,Column)
  }

};
